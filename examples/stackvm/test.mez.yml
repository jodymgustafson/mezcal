stackvm:
  version: "0.0.0"
  name: examples/stackvm/test.mez
  functions:
  - name: main
    description: main
    definition: |
      start:
      push ""
      put a$
      pop
      __0: # begin while
      get a$
      push "q"
      call str.compare
      push 0
      cmp
      beq __1
      pop
      push "Convert from celsius or fahrenheit or quit (c/f/q)?"
      call writeln
      pop
      call readln
      put a$
      pop
      # begin if
      get a$
      push "f"
      call str.compare
      push 0
      cmp
      bne __2
      pop
      push "Fahrenheit:"
      call writeln
      pop
      call readln
      put f
      pop
      get f
      call convert_f2c
      put c
      pop
      push "Celsius: "
      get c
      call str.concat
      call writeln
      pop
      bra __3
      __2: # else
      pop
      # begin if
      get a$
      push "c"
      call str.compare
      push 0
      cmp
      bne __4
      pop
      push "Celsius:"
      call writeln
      pop
      call readln
      put c
      pop
      get c
      call convert_c2f
      put f
      pop
      push "Fahrenheit: "
      get f
      call str.concat
      call writeln
      pop
      bra __5
      __4: # else
      pop
      # begin if
      get a$
      push "q"
      call str.compare
      push 0
      cmp
      beq __6
      pop
      push "Invalid command: "
      get a$
      call str.concat
      call writeln
      pop
      __6: # end if
      pop
      __5: # end if
      __3: # end if
      bra __0
      __1: # end while
      pop
      push "Bye!"
      call writeln
      pop
      end
  - name: convert_c2f
    description: convert_c2f
    definition: |
      start:
      put c
      pop
      get c
      push 9
      mul
      push 5
      div
      push 32
      add
      end
  - name: convert_f2c
    description: convert_f2c
    definition: |
      start:
      put f
      pop
      get f
      push 32
      sub
      push 5
      mul
      push 9
      div
      end
  - name: convert_km2m
    description: convert_km2m
    definition: |
      start:
      put k
      pop
      get k
      push 1.60934
      div
      end
  - name: convert_m2km
    description: convert_m2km
    definition: |
      start:
      put m
      pop
      get m
      push 1.60934
      mul
      end
  - name: convert_kg2lb
    description: convert_kg2lb
    definition: |
      start:
      put k
      pop
      get k
      push 2.20462
      mul
      end
  - name: convert_lb2kg
    description: convert_lb2kg
    definition: |
      start:
      put p
      pop
      get p
      push 2.20462
      div
      end
  - name: convert_g2oz
    description: convert_g2oz
    definition: |
      start:
      put g
      pop
      get g
      push 28.34955683972748
      div
      end
  - name: convert_oz2g
    description: convert_oz2g
    definition: |
      start:
      put o
      pop
      get o
      push 28.34955683972748
      mul
      end